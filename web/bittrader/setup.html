<html>
<head>
<title>Bittrader Setup page</title>
<link href="//cdn.jsdelivr.net/jquery.layout/1.3.0rc30.79/layout-default-latest.css"
        rel="stylesheet" type="text/css">
<link rel="stylesheet"
      href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">
<script type="text/javascript" src="//cdn.jsdelivr.net/jquery/1.10/jquery.min.js"></script>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.js"></script>
<style type="text/css">
#logframe {
width: 100%;
}
#log {
height: 300px;
width: 100%;
}
</style>
<script>
function run_bootstrap() {
$.get("/cgi-bin/bittrader/model.py/bootstrap",
function(data) {
$("#log").attr("src", "/cgi-bin/bittrader/model.py/log/bootstrap");
});
}


function check_installed() {
$.getJSON("/cgi-bin/bittrader/model.py/version/bootstrap_status",
function(data) {
if (!data["bootstrap_finished"]) {
$('.bootstrap-yes').hide();
$('.bootstrap-no').show();
if (!data['bootstrap_running']) {
$('#bootstrap-notice').html("<b>System install not started</b> - <a href='javascript:run_bootstrap()'>Start installation</a>");
} else {
$('#bootstrap-notice').html("<b>System install currently running</b> - <a href='/cgi-bin/bittrader/model.py/log/bootstrap' target='log'>View log</a>");
window.setTimeout(function() { check_installed();}, 10000);
}
} else {
    $('#bootstrap-notice').html("System install finished - <a href='javascript:run_bootstrap()'>Start installation</a>");
    $('.bootstrap-yes').show();
    $('.bootstrap-no').hide();
}});
}

function check_password() {
$.getJSON("/cgi-bin/bittrader/model.py/version/default_password",
function(data) {
if (data['default_password']) {
$("#password-input").show();
$("#password-done").hide();
} else {
$("#password-input").hide();
$("#password-done").show();
};
});
}

</script>

</head>
<body>
<div id="password-input" style="display:none">
<h4>Password for user and root</h4>
Warning: system is currently using default password 'cubswin:)'
<form action='/cgi-bin/bittrader/model.py/passwd' target='log'
      METHOD='POST'>
New Password: <input name='newpass1' type='password' title='Please Enter Your Password' size='8' /><br />
Confirm Password: <input name='newpass2' type='password' title='Please Enter Your Password' size='8' /><br />
<input type='submit' value='SUBMIT' />
</form>
</div>
<div id="password-done" style="display:none">
Passwords already set.  To reset password log into the machine.
</div>
<ul>
<li><a href="index.html">Bittrader main page</a>
<li><span id="bootstrap-notice"></span>
<li><a href="log" target="_blank">Server log files</a>
</ul>
<div class="bootstrap-yes">
<form action='/cgi-bin/bittrader/model.py/setup' target='log'
      METHOD='POST'>
<ul>
User Password: <input name='password' type='password' title='Please
		 Enter Your Password' size='8' /><br>
<li>Auxillary Servers: <input type="submit" name="submit"
			      value="Startup servers">
<input type="submit" name="submit" value="Shutdown servers">

<li>Ssh remote access: <input type="submit" name="submit"
			      value="Startup ssh">
<input type="submit" name="submit" value="Shutdown ssh">
<li><input type="submit" name="submit" value="Refresh CGI scripts">
<li><input type="submit" name="submit" value="Remove local install">
</ul>
</form>
</div>

<p>
<iframe id="log" name="log" onload="check_installed(); check_password()">
</iframe>
</div>
<script>
check_installed();
check_password();
$("#logframe").resizable({});
</script>

</body>
</html>

